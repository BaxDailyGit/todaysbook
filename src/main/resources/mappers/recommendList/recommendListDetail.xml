<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.todaysbook.repository.RecommendListMapper">
    <select id="getRecommendListByListId" resultType="com.example.todaysbook.domain.dto.RecommendListDto">
        SELECT url.id AS listId, url.user_id AS userId, url.title AS listTitle, u.nick_name AS nickname, url.date
        FROM user_recommend_list url
        LEFT JOIN user u
        ON url.user_id=u.id
        WHERE url.id=#{listId}
        GROUP BY listId;
    </select>

    <select id="getBookDetailByListId" resultType="com.example.todaysbook.domain.dto.BookDto">
        SELECT b.id, b.title, b.author, b.price, b.image_path AS image
        FROM user_recommend_book urb
        LEFT JOIN book b
        ON urb.book_id=b.id
        WHERE urb.user_recommend_list_id=#{listId};
    </select>

    <select id="getMyRecommendListAllByUserId" resultType="com.example.todaysbook.domain.dto.RecommendListDto">
        SELECT url.id AS listId, url.user_id AS userId, url.title AS listTitle, u.nick_name AS nickname, url.date
        FROM user_recommend_list url
                 LEFT JOIN user u
                           ON url.user_id=u.id
        WHERE url.user_id=#{userId}
        GROUP BY listId;
    </select>
</mapper>